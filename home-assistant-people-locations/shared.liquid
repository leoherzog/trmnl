{% template main %}
{% comment %}
Main template for displaying people locations
Parameters:
- people: Array of person objects with name, zone, entity_id, and zone_icon
- columns: Number of columns (1 or 2)
- size: Optional size modifier ("small" for compact display)
{% endcomment %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css">

{% comment %} Determine grid columns based on layout {% endcomment %}
{% if columns == 2 %}
  <div class="grid grid--cols-2 gap--medium h--full">
{% else %}
  <div class="grid grid--cols-1 gap--small h--full">
{% endif %}
  {% for person in people %}
    <div class="flex flex--col flex--center">
      <div class="label label--outline {% if size == 'small' %} label--small {% else %} px--2 py--1 {% endif %}">
        {% assign icon_class = person.zone_icon | replace: ":", "-" %}
        <i class="mx--1 mdi {{ icon_class }}"></i>
        <span>
          {% if person.zone == "home" %} Home {% elsif person.zone == "not_home" %} Away {% else %} {{ person.zone }} {% endif %}
        </span>
        <span class="mx--1">|</span>
        <span>{{ person.name }}</span>
      </div>
    </div>
  {% endfor %}
</div>

{% endtemplate %}

{% template title_bar %}
{% comment %}
Title bar template with layout size control
Parameters:
- updated: Timestamp of last update
- format: "long" or "short"; Default "long"
{% endcomment %}
<div class="title_bar">
  <svg class="image image-stroke image--dither" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M240 224.762C240 233.012 233.25 239.762 225 239.762H15C6.75 239.762 0 233.012 0 224.762V134.762C0 126.512 4.77 114.993 10.61 109.153L109.39 10.3725C115.22 4.5425 124.77 4.5425 130.6 10.3725L229.39 109.162C235.22 114.992 240 126.522 240 134.772V224.772V224.762Z" fill="#F2F4F9"/>
    <path d="M229.39 109.153L130.61 10.3725C124.78 4.5425 115.23 4.5425 109.4 10.3725L10.61 109.153C4.78 114.983 0 126.512 0 134.762V224.762C0 233.012 6.75 239.762 15 239.762H107.27L66.64 199.132C64.55 199.852 62.32 200.262 60 200.262C48.7 200.262 39.5 191.062 39.5 179.762C39.5 168.462 48.7 159.262 60 159.262C71.3 159.262 80.5 168.462 80.5 179.762C80.5 182.092 80.09 184.322 79.37 186.412L111 218.042V102.162C104.2 98.8225 99.5 91.8425 99.5 83.7725C99.5 72.4725 108.7 63.2725 120 63.2725C131.3 63.2725 140.5 72.4725 140.5 83.7725C140.5 91.8425 135.8 98.8225 129 102.162V183.432L160.46 151.972C159.84 150.012 159.5 147.932 159.5 145.772C159.5 134.472 168.7 125.272 180 125.272C191.3 125.272 200.5 134.472 200.5 145.772C200.5 157.072 191.3 166.272 180 166.272C177.5 166.272 175.12 165.802 172.91 164.982L129 208.892V239.772H225C233.25 239.772 240 233.022 240 224.772V134.772C240 126.522 235.23 115.002 229.39 109.162V109.153Z" fill="#18BCF2"/>
  </svg>
  <span class="title">{% if format == "short" %} People {% else %} Home Assistant People Locations {% endif %}</span>
  {% assign updated_iso = updated | date: "%s" | plus: trmnl.user.utc_offset | date: "%Y-%m-%dT%H:%M:%S%z" %}
  {% if trmnl.plugin_settings.custom_fields_values.timemode == '24_hour' %}
    {% if format == 'short' %}
      {% assign mask = '%H:%M' %}
    {% else %}
      {% assign mask = '%-m/%-d %H:%M' %}
    {% endif %}
  {% else %}
    {% if format == 'short' %}
      {% assign mask = '%-I:%M%P' %}
    {% else %}
      {% assign mask = '%-m/%-d %-I:%M%P' %}
    {% endif %}
  {% endif %}
  <span class="instance">Updated {{ updated_iso | l_date: mask , trmnl.user.locale }}</span>
</div>
{% endtemplate %}
